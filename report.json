[
  {
    "coverage": {
      "files": {
        "codigo.c": {
          "coverage_stats": {
            "covered_lines": 4,
            "total_hits": 7
          },
          "covered_lines": {
            "20": {
              "covered": true,
              "hits": 1,
              "type": "execution"
            },
            "23": {
              "covered": true,
              "hits": 1,
              "type": "violation"
            },
            "4": {
              "covered": true,
              "hits": 1,
              "type": "execution"
            },
            "8": {
              "covered": true,
              "hits": 4,
              "type": "execution"
            }
          }
        }
      }
    },
    "initial_values": {
      "c": {
        "name": "c",
        "type": "signed",
        "value": "1"
      },
      "ponteiro": {
        "name": "ponteiro",
        "type": "pointer",
        "value": {
          "__type": "pointer",
          "address": "(signed int *)(&dynamic_3_value)",
          "value": "*((signed int *)(&dynamic_3_value))"
        }
      }
    },
    "source_files": {
      "codigo.c": [
        "#include <stdlib.h>",
        "",
        "void processa(int condicao) {",
        "    int *ponteiro = (int*) malloc(sizeof(int));",
        "",
        "    if (ponteiro == NULL) return;",
        "",
        "    *ponteiro = 10;",
        "",
        "    if (condicao) {",
        "        // Caminho onde o free() não é chamado",
        "        return;",
        "    }",
        "",
        "    // O ponteiro só é liberado neste caminho",
        "    free(ponteiro);",
        "}",
        "",
        "int main() {",
        "    int c; // O ESBMC testará diferentes valores para 'c'",
        "    processa(c);",
        "    return 0;",
        "}"
      ]
    },
    "status": "violation",
    "steps": [
      {
        "assignment": {
          "lhs": "c",
          "lhs_type": "signed",
          "rhs": "1",
          "rhs_type": "signed"
        },
        "file": "codigo.c",
        "function": "main",
        "line": "20",
        "step_number": 0,
        "type": "assignment"
      },
      {
        "assignment": {
          "lhs": "ponteiro",
          "lhs_type": "pointer",
          "rhs": {
            "__type": "pointer",
            "address": "(signed int *)(&dynamic_3_value)",
            "value": "*((signed int *)(&dynamic_3_value))"
          },
          "rhs_type": "pointer"
        },
        "file": "codigo.c",
        "function": "processa",
        "line": "4",
        "step_number": 1,
        "type": "assignment"
      },
      {
        "file": "codigo.c",
        "function": "processa",
        "line": "8",
        "step_number": 2,
        "type": "assert"
      },
      {
        "file": "codigo.c",
        "function": "processa",
        "line": "8",
        "step_number": 3,
        "type": "assert"
      },
      {
        "file": "codigo.c",
        "function": "processa",
        "line": "8",
        "step_number": 4,
        "type": "assert"
      },
      {
        "file": "codigo.c",
        "function": "processa",
        "line": "8",
        "step_number": 5,
        "type": "assert"
      },
      {
        "assertion": {
          "comment": "dereference failure: forgotten memory: dynamic_3_value",
          "guard": "1",
          "violated": true
        },
        "file": "codigo.c",
        "function": "main",
        "line": "23",
        "message": "dereference failure: forgotten memory: dynamic_3_value",
        "step_number": 6,
        "type": "violation"
      }
    ]
  }
]
